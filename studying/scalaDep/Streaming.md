# Spark Streaming

## 流数据概述
本节内容首先介绍静态数据和流数据的区别，以及针对这两种数据的计算模式，即批量计算和实时计算，然后介绍计算的概念、框架和处理流程。

### 静态数据和流数据
数据总体上分为静态数据和流数据

**1.静态数据**  
很多企业为了支持决策分析而构建的数据仓库（如下图）其中存放的大量历史数据就是静态数据，这些数据来自不同的数据源，利用ETL(Extract-Transform-Load)工具加载到数据仓库中，并且不会发生更新，技术人员可以利用数据挖掘和OLAP(On-Line Analytical Processing)分析工具从这些静态数据中找到对企业有价值的信息。

<img src='./pics/1.png' width="80%">

**2.数据流**  
近年来，在Web应用、网络监控、传感检测、电信金融、生产制造等领域，兴起了一种新的数据密集型应用——流数据，即数据以大量、快速、时变的流形式持续到达。以传感检测为例，在大气中放置PM2.5传感器实时监测大气中的PM2.5的浓度，检测数据会源源不断地实时传输回数据中心，检测系统对回传数据进行实时分析，预判空气质量变化趋势，如果空气质量在未来一段时间内会达到影响人体健康的程度，就启动应急响应机制。

从概念上而言，流数据（或数据流）是指在时间分布和数量上无限的一系列动态数据集合体；数据记录是流数据的最小组成单元。流数据具有以下特征。
- 数据快速持续到达，潜在大小也许是无穷无尽的
- 数据来源众多，格式复杂
- 数据量大，但是不十分关注存储，一旦流数据中的某个元素经过处理，要么被丢弃，那么被归档存储
- 注重数据的整体价值，不过分关注个别数据
- 数据顺序颠倒，或者不完整，系统无法控制将要处理的新到达的数据元素的顺序

### 批量计算和实时计算
对静态数据和流数据的处理，对应着两种截然不同的计算模式：**批量计算**和**实时计算**。批量计算以“静态数据”为对象，可以在很充裕的时间内对海量数据进行批量处理，计算得到有价值的信息。Hadoop就是典型的批处理模型，由HDFS和HBase存放大量的静态数据，由MapReduce负责对海量数据执行批量计算。

<img src='./pics/2.png' width='60%'>

流数据不适合采用批量计算，因为流数据不适合传统的关系模型建模，不能把源源不断的流数据保存到数据库中，流数据被处理后，一部分进入数据库成为静态数据，其他部分则直接被丢弃。传统的关系数据库通常用于满足信息实时交互处理需求。

流数据必须采用实时计算，实时计算最重要的一个需求是能够实时得到计算结果，一般要求响应时间为秒级。当只需要处理少量数据时，实时计算并不是问题；但是，在大数据时代，不仅数据格式复杂、来源众多，而且数据量巨大，这就对实时计算提出了很大的挑战。


### 流计算概念

下图是一个流计算的示意图，流计算平台实时获取来自不同数据源的海量数据，通过实时分析处理，获取有价值的信息。  
<img src='./pics/3.png' width='80%'>

流计算秉承一个基本理念，即数据的价值随着时间的流逝而降低。因此，当事件出现时就应该立即进行处理，而不是缓存起来进行批量处理。为了及时处理流数据，就需要一个低延迟、可扩展、高可靠的处理引擎。对于一个流计算系统来说，它应达到如下需求。 
- 高性能。处理大数据的基本要求，如每秒处理几十万数据
- 海量式。支持TB级甚至是PB级的数据规模
- 实时性。必须保证一个较低的延迟时间
- 分布式。支持大数据的基本架构，必须能够平滑扩展
- 易用性。能够快速进行开发和部署
- 可靠性。能够可靠地处理流数据

针对不同的应用场景，相应的流计算系统会有不同的需求，但是，针对海量数据的流计算，无论在数据采集、数据处理中的都应达到秒级别的要求。

### 流计算框架
- 商业级流计算平台
    - IMB InfoSphere Streams。商业级高级计算平台，可以帮助用户额开发应用程序来快速摄取、分析和关联来自数千个实时源的信息
    - IBM StreamBase。IBM开发的另一款商业流计算系统，在金融部门和政府部门使用

- 开源流计算框架
    - Twitter Storm。免费、开源的分布式实时计算系统，可简单、高效、可靠地处理大量的流数据；阿里巴巴的JStorm，是参考Twitter Storm开发的实时流式计算框架，在网络I/O、线程模型、资源调度、可用性及稳定性上做了持续改进。
    - Yahoo! S4(Simple Scalable Streaming System)。开源流计算平台，是通用的、分布式的、可扩展的、分区容错的、可插拔的流式系统

- 公司为支持自身业务开发的流计算框架
    - Facebook Puma。Facebook使用Puma和HBase相结合来处理实时数据
    - DStream。百度开发的实时流数据计算系统
    - 银河流数据处理平台。淘宝开发的通用流数据实时计算系统
    - 



